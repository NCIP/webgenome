<?xml version="1.0" encoding="ISO-8859-1" ?>

<!--L
   Copyright RTI International

   Distributed under the OSI-approved BSD 3-Clause License.
   See http://ncip.github.com/webgenome/LICENSE.txt for details.
L-->

<!DOCTYPE struts-config PUBLIC
          "-//Apache Software Foundation//DTD Struts Configuration 1.1//EN"
          "struts-config_1_1.dtd">

<struts-config>


	<!-- ====================================================== -->
	<!--                    Form Beans                          -->
	<!-- ====================================================== -->
	<form-beans>
		<form-bean
			name="defaultForm"
			type="org.rti.webcgh.webui.MapBackedForm"/>
		<form-bean
			name="virtualExperimentForm"
			type="org.rti.webcgh.webui.virtual.VirtualExperimentForm"/>
		<form-bean
			name="plotParamsForm"
			type="org.rti.webcgh.webui.plot.PlotParamsForm"/>
		<form-bean
			name="plotSaveAsForm"
			type="org.rti.webcgh.webui.plot.SaveAsForm"/>
		<form-bean
			name="pipelineForm"
			type="org.rti.webcgh.webui.pipeline.PipelineForm"/>
		<form-bean
			name="loginForm"
			type="org.rti.webcgh.webui.profile.LoginForm"/>
		<form-bean
			name="dataSelectionForm"
			type="org.rti.webcgh.webui.DataSelectionForm"/>
		<form-bean
			name="skyForm"
			type="org.rti.webcgh.webui.admin.SkyForm"/>
		<form-bean
			name="cytobandForm"
			type="org.rti.webcgh.webui.admin.CytobandForm"/>
		<form-bean
			name="annotationForm"
			type="org.rti.webcgh.webui.admin.AnnotationForm"/>
		<form-bean
			name="probeSetForm"
			type="org.rti.webcgh.webui.admin.ProbeSetForm"/>
		<form-bean
			name="uploadExperimentForm"
			type="org.rti.webcgh.webui.UploadExperimentForm"/>

	</form-beans>


	<!-- =========================================================== -->
	<!--                   Exception handlers                        -->
	<!-- =========================================================== -->
	<global-exceptions>

    <exception
    	type="org.rti.webcgh.webui.SessionTimeoutException"
    	path="session.timeout.exception.page"
    	key="session.timeout"
    	handler="org.rti.webcgh.webui.WebcghExceptionHandler"
    	scope="request"/>

    <exception
    	type="org.rti.webcgh.domain.analytic.DataSetInvalidationException"
    	path="data.invalidation.page"
    	key="data.invalidation"
    	handler="org.rti.webcgh.webui.WebcghExceptionHandler"
    	scope="request"/>

    <exception
    	type="org.rti.webcgh.core.WebcghSecurityException"
    	path="security.exception.page"
    	key="security.exception"
    	handler="org.rti.webcgh.webui.WebcghExceptionHandler"
    	scope="request"/>

    <exception
    	type="org.rti.webcgh.core.WebcghSystemException"
    	path="system.exception.page"
    	key="system.exception"
    	handler="org.rti.webcgh.webui.WebcghExceptionHandler"
    	scope="request"/>

    <exception
    	type="org.rti.webcgh.core.WebcghApplicationException"
    	path="application.exception.page"
    	key="application.exception"
    	handler="org.rti.webcgh.webui.WebcghExceptionHandler"
    	scope="request"/>

    <exception
    	type="java.lang.Exception"
    	path="unknown.exception.page"
    	key="system.exception"
    	handler="org.rti.webcgh.webui.WebcghExceptionHandler"
    	scope="request"/>

  	</global-exceptions>



	<!-- ================================================= -->
	<!--                   Actions                         -->
	<!-- ================================================= -->
	<action-mappings>

		<action
			path="/home"
			type="org.apache.struts.actions.ForwardAction"
			parameter="home.page"/>

		<action
			path="/svgTest"
			type="org.apache.struts.actions.ForwardAction"
			parameter="svg.test.page"/>

		<action
			path="/svgInstall"
			type="org.apache.struts.actions.ForwardAction"
			parameter="svg.install.page"/>


		<!-- ================================================= -->
		<!--        User profile related actions               -->
		<!-- ================================================= -->

		<action
			path="/profile/loginPage"
			type="org.apache.struts.actions.ForwardAction"
			parameter="profile.login.page"/>

		<action
			path="/profile/login"
			name="loginForm"
			scope="session"
			validate="true"
			input="/profile/loginPage.do">
			<forward name="success" path="login.confirm.page"/>
			<forward name="failure" path="/profile/loginPage.do"/>
			<forward name="admin" path="/admin/home.do"/>
		</action>

		<action
			path="/profile/logout"
			name="loginForm"
			scope="session"
			validate="false">
			<forward name="success" path="/home.do"/>
		</action>

		<!-- ================================================= -->
		<!--       Virtual experiment related actions          -->
		<!-- ================================================= -->

		<action
			path="/virtual/list">
			<forward name="success" path="virtual.list.page"/>
		</action>

		<action
			path="/virtual/selectExperiments">
			<forward name="success" path="virtual.select.experiments.page"/>
		</action>

		<action
			path="/virtual/recordSelectedExperiments"
			type="org.apache.struts.actions.ForwardAction"
			name="dataSelectionForm"
			scope="session"
			validate="true"
			input="/virtual/selectExperiments.do"
			parameter="/virtual/selectBioAssays.do"/>

		<action
			path="/virtual/selectBioAssays"
			name="dataSelectionForm"
			scope="session"
			validate="false">
			<forward name="success" path="virtual.select.bioassays.page"/>
		</action>

		<action
			path="/virtual/recordSelectedBioAssays"
			type="org.apache.struts.actions.ForwardAction"
			name="dataSelectionForm"
			scope="session"
			validate="true"
			input="/virtual/selectBioAssays.do"
			parameter="/virtual/annotation.do"/>

		<action
			path="/virtual/annotation"
			type="org.apache.struts.actions.ForwardAction"
			parameter="virtual.annotation.page"/>

		<action
			path="/virtualRecordAnnotation"
			type="org.apache.struts.actions.ForwardAction"
			name="virtualExperimentForm"
			scope="session"
			validate="true"
			input="/virtual/annotation.do"
			parameter="/virtual/summary.do"/>

		<action
			path="/virtual/summary"
			name="virtualExperimentForm"
			scope="session"
			validate="false"
			type="org.apache.struts.actions.ForwardAction"
			parameter="virtual.summary.page"/>

		<action
			path="/virtual/save"
			name="virtualExperimentForm"
			scope="session"
			validate="false">
			<forward name="success" path="virtual.confirm.page"/>
		</action>

		<action
			path="/virtual/delete"
			name="defaultForm">
			<forward name="success" path="virtual.confirm.page"/>
		</action>


		<!-- ================================================ -->
		<!--         Analytic pipeline related actions        -->
		<!-- ================================================ -->

		<action
			path="/pipeline/show"
			name="pipelineForm"
			scope="request"
			validate="false">
			<forward name="no.pipelines" path="no.pipelines.page"/>
			<forward name="success" path="pipelines.page"/>
		</action>

		<action
			path="/pipeline/new"
			name="pipelineForm"
			scope="request"
			validate="false">
			<forward name="success" path="pipeline.edit.page"/>
		</action>

		<action
			path="/pipeline/addOperation"
			type="org.rti.webcgh.webui.pipeline.AddOperationAction"
			name="pipelineForm"
			scope="request"
			validate="false">
			<forward name="success" path="pipeline.edit.page"/>
		</action>

		<action
			path="/pipeline/removeOperation"
			name="pipelineForm"
			scope="request"
			validate="false">
			<forward name="success" path="pipeline.edit.page"/>
		</action>

		<action
			path="/pipeline/save"
			name="pipelineForm"
			scope="request"
			input="pipeline.edit.page"
			validate="true">
			<forward name="success" path="pipeline.confirm.modification.page"/>
			<forward name="failure" path="pipeline.edit.page"/>
		</action>

		<action
			path="/pipeline/delete"
			name="pipelineForm"
			scope="request"
			validate="false">
			<forward name="success" path="pipeline.confirm.modification.page"/>
		</action>

		<action
			path="/pipeline/edit"
			name="pipelineForm"
			scope="request"
			validate="false">
			<forward name="success" path="pipeline.edit.page"/>
		</action>

		<!-- ==================================================== -->
		<!--          Application Client                          -->
		<!-- ==================================================== -->

		<action
			path="/client/plot"
			name="plotParamsForm"
			scope="session"
			validate="false">
			<forward name="success" path="/plot/setup.do"/>
		</action>

		<!-- ==================================================== -->
		<!--          Shopping cart actions                       -->
		<!-- ==================================================== -->

		<action
			path="/cart/contents"
			name="plotParamsForm"
			scope="session"
			validate="false">
			<forward name="success" path="cart.contents.page"/>
			<forward name="emptyCart" path="cart.empty.page"/>
		</action>

		<action
			path="/cart/removeExperiments"
			name="dataSelectionForm"
			scope="session"
			validate="true">
			<forward name="success" path="/cart/contents.do"/>
		</action>

		<action path="/cart/selectExperiments">
			<forward name="success" path="cart.select.experiments.page"/>
		</action>

		<action
			path="/cart/uploadExperiment"
			name="uploadExperimentForm"
			scope="session"
			parameter="methodToCall"
			validate="false">
			<forward name="viewUpload" path="cart.view.upload.page"/>
			<forward name="success" path="/cart/selectExperimentTypes.do"/>
		</action>

		<action
			path="/cart/recordSelectedExperiments"
			name="dataSelectionForm"
			scope="request"
			validate="true"
			input="/cart/selectExperiments.do">
			<forward name="success" path="/cart/selectExperimentTypes.do"/>
		</action>

		<action
			path="/cart/selectExperimentTypes">
			<forward name="success" path="cart.select.experiment.types.page"/>
		</action>

		<action
			path="/cart/recordSelectedExperimentTypes"
			name="defaultForm">
			<forward name="success" path="/cart/selectArrays.do"/>
			<forward name="noExperimentTypes" path="/cart/selectExperimentTypes.do"/>
			<forward name="splits" path="cart.experiment.type.splits.page"/>
		</action>

		<action path="/cart/selectArrays">
			<forward name="success" path="cart.select.arrays.page"/>
		</action>

		<action
			path="/cart/recordArrays"
			name="defaultForm">
			<forward name="success" path="/cart/selectAssembly.do"/>
			<forward name="noProbeSets" path="/cart/selectArrays.do"/>
			<forward name="splits" path="cart.organism.splits.page"/>
		</action>

		<action
			path="/cart/selectAssembly">
			<forward name="success" path="cart.select.assembly.page"/>
		</action>

		<action
			path="/cart/mapProbes"
			name="defaultForm">
			<forward name="success" path="cart.probe.mapping.results.page"/>
			<forward name="noAssembly" path="/cart/selectAssembly.do"/>
		</action>

		<!-- ================================================ -->
		<!--             Plot related actions                 -->
		<!-- ================================================ -->

		<action
			path="/plot/params"
			name="plotParamsForm"
			scope="session"
			validate="false">
			<forward name="success" path="plot.params.page"/>
		</action>

		<action
			path="/recordPlotParams"
			type="org.apache.struts.actions.ForwardAction"
			name="plotParamsForm"
			scope="session"
			validate="true"
			input="/plot/params.do"
			parameter="confirm.change.plot.params.page"/>

		<action
			path="/configPlotParams"
			type="org.rti.webcgh.webui.plot.PlotParamsConfigAction"
			name="plotParamsForm"
			scope="session"
			validate="false">
			<forward name="scatterPlotConfig" path="scatter.plot.params.page"/>
			<forward name="ideogramPlotConfig" path="ideogram.plot.params.page"/>
			<forward name="readyToPlot" path="/recordConfigPlotParams.do"/>
		</action>


		<action
			path="/configScatterPlotParams"
			type="org.rti.webcgh.webui.plot.PlotParamsConfigAction"
			name="plotParamsForm"
			scope="session"
			validate="true"
			input="/configPlotParams.do">
			<forward name="scatterPlotConfig" path="scatter.plot.params.page"/>
			<forward name="ideogramPlotConfig" path="ideogram.plot.params.page"/>
			<forward name="readyToPlot" path="/recordConfigPlotParams.do"/>
		</action>

		<action
			path="/configIdeogramPlotParams"
			type="org.rti.webcgh.webui.plot.PlotParamsConfigAction"
			name="plotParamsForm"
			scope="session"
			validate="true"
			input="/configPlotParams.do">
			<forward name="scatterPlotConfig" path="scatter.plot.params.page"/>
			<forward name="ideogramPlotConfig" path="ideogram.plot.params.page"/>
			<forward name="readyToPlot" path="/recordConfigPlotParams.do"/>
		</action>

		<action
			path="/recordConfigPlotParams"
			type="org.rti.webcgh.webui.plot.PlotParamsConfigRecordAction"
			name="plotParamsForm"
			scope="session"
			validate="true"
			input="/configPlotParams.do">
			<forward name="scatterPlotReadyToPlot" path="confirm.configure.scatter.plot.params.page"/>
			<forward name="ideogramPlotReadyToPlot" path="confirm.configure.ideogram.plot.params.page"/>
		</action>


		<action
			path="/updateSelectedFeatureTypes"
			type="org.rti.webcgh.webui.plot.FeatureTypesSetupAction"
			name="plotParamsForm"
			scope="session"
			validate="false">
			<forward name="success" path="update.selected.feature.types.page"/>
			<forward name="no.assembly" path="/plot/params.do"/>
		</action>

		<action
			path="/plot/setup"
			name="plotParamsForm"
			scope="session"
			validate="true"
			input="/plot/params.do">
			<forward name="scatter" path="scatter.plot.page"/>
			<forward name="frequency" path="frequency.plot.page"/>
			<forward name="annotation" path="annotation.plot.page"/>
			<forward name="ideogram" path="ideogram.plot.page"/>
			<forward name="bar" path="bar.plot.page"/>
			<forward name="no.data" path="cart.empty.page"/>
			<forward name="no.intervals" path="/plot/params.do"/>
			<forward name="incompatible.assemblies" path="/plot/params.do"/>
		</action>

		<action
			path="/annotationReport"
			type="org.rti.webcgh.webui.plot.AnnotationReportAction"
			name="plotParamsForm"
			scope="session"
			validate="false">
			<forward name="success" path="annotation.report.page"/>
		</action>

		<action
			path="/plot/svg"
			name="plotParamsForm"
			validate="false"
			scope="session">
			<forward name="success" path="/WEB-INF/jsp/plot/showSvg.jsp"/>
		</action>

		<action
			path="/plot/saveAs"
			name="plotSaveAsForm"
			scope="session"
			validate="false">
			<forward name="success" path="plot.saveAs.page"/>
		</action>

		<action
			path="/fileDownload"
			type="org.rti.webcgh.webui.download.FileDownloadAction">
			<forward name="success" path="annotation.report.page"/>
		</action>

		<!-- ======================================================== -->
		<!--           Administrator actions                          -->
		<!-- ======================================================== -->

		<action
			path="/admin/home"
			type="org.apache.struts.actions.ForwardAction"
			parameter="admin.home.page"/>

		<action
			path="/admin/showSky">
			<forward name="success" path="admin.show.sky.page"/>
		</action>

		<action
			path="/admin/loadSkyForm"
			type="org.apache.struts.actions.ForwardAction"
			parameter="admin.load.sky.page"/>

		<action
			path="/admin/loadSkyData"
			name="skyForm"
			validate="true"
			input="admin.load.sky.page"
			scope="session">
			<forward name="success" path="/admin/showSky.do"/>
		</action>

		<action path="/admin/deleteSkyData">
			<forward name="success" path="/admin/showSky.do"/>
		</action>

		<action path="/admin/showCytobands">
			<forward name="success" path="admin.show.cytobands.page"/>
		</action>

		<action
			path="/admin/loadCytobandsForm"
			type="org.apache.struts.actions.ForwardAction"
			parameter="admin.load.cytobands.page"/>

		<action
			path="/admin/loadCytobands"
			name="cytobandForm"
			validate="true"
			scope="session"
			input="admin.load.cytobands.page">
			<forward name="success" path="/admin/showCytobands.do"/>
		</action>

		<action path="/admin/deleteCytobands">
			<forward name="success" path="/admin/showCytobands.do"/>
		</action>

		<action path="/admin/showAnnotation">
			<forward name="success" path="admin.show.annotation.page"/>
		</action>

		<action
			path="/admin/loadAnnotationForm"
			type="org.apache.struts.actions.ForwardAction"
			parameter="admin.load.annotation.page"/>

		<action
			path="/admin/loadAnnotation"
			name="annotationForm"
			validate="true"
			scope="session"
			input="admin.load.annotation.page">
			<forward name="success" path="/admin/showAnnotation.do"/>
		</action>

		<action path="/admin/deleteAnnotation">
			<forward name="success" path="/admin/showAnnotation.do"/>
		</action>

		<action path="/admin/showArrays">
			<forward name="success" path="admin.show.arrays.page"/>
		</action>

		<action
			path="/admin/loadArrayForm"
			type="org.apache.struts.actions.ForwardAction"
			parameter="admin.load.array.page"/>

		<action
			path="/admin/loadArray"
			name="probeSetForm"
			validate="true"
			scope="session"
			input="admin.load.array.page">
			<forward name="success" path="/admin/showArrays.do"/>
		</action>

		<action path="/admin/deleteArray">
			<forward name="success" path="/admin/showArrays.do"/>
		</action>


	</action-mappings>


	<!-- ==================================================== -->
	<!--            Controller                                -->
	<!-- ==================================================== -->


	<controller>
	  <set-property property="processorClass"
	      value="org.springframework.web.struts.DelegatingTilesRequestProcessor"/>
	</controller>

	<!-- =========================================================== -->
	<!--                  Plug-ins                                   -->
	<!-- =========================================================== -->
	<plug-in className="org.apache.struts.tiles.TilesPlugin" >
	    <set-property property="definitions-config"
		                 value="/WEB-INF/tiles-config.xml" />
	    <set-property property="moduleAware" value="true" />
	    <set-property property="definitions-parser-validate" value="true" />
	</plug-in>

	<plug-in className="org.springframework.web.struts.ContextLoaderPlugIn">
	  <set-property property="contextConfigLocation"
	      value="/WEB-INF/applicationContext.xml"/>
	</plug-in>



</struts-config>
