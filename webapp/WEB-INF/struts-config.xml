<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE struts-config PUBLIC
          "-//Apache Software Foundation//DTD Struts Configuration 1.1//EN"
          "struts-config_1_1.dtd">

<struts-config>

	<!-- ====================================================== -->
	<!--                    Form Beans                          -->
	<!-- ====================================================== -->

	<form-beans>

	<!-- Login form -->
		<form-bean
			name="login.form"
			type="org.rti.webgenome.webui.struts.user.LoginForm"/>

	<!-- New account form -->
		<form-bean
			name="new.account.form"
			type="org.rti.webgenome.webui.struts.user.NewAccountForm"/>

	<!-- Plot parameters form -->
		<form-bean
			name="plot.parameters.form"
			type="org.rti.webgenome.webui.struts.cart.PlotParametersForm"/>

	<!-- Selected experiments form -->
		<form-bean
			name="selected.experiments.form"
			type="org.rti.webgenome.webui.struts.cart.SelectedExperimentsForm"/>

	<!-- Name change form -->
		<form-bean
			name="name.change.form"
			type="org.rti.webgenome.webui.struts.cart.NameChangeForm"/>

	<!-- Analytic operation parameters form -->
		<form-bean
			name="analytic.operation.params.form"
			type="org.rti.webgenome.webui.struts.cart.AnalyticOperationParametersForm"/>

	<!-- Form for specifying annotation data to upload -->
		<form-bean
			name="annotation.upload.form"
			type="org.rti.webgenome.webui.struts.admin.AnnotationUploadForm"/>
			
	<!-- Form for specifying a quantitation type -->
		<form-bean
			name="quantitation.type.form"
			type="org.rti.webgenome.webui.struts.cart.QuantitationTypeForm"/>
			
	<!-- Form for attaching a data or reporter file to an upload -->
		<form-bean
			name="attach.data.form"
			type="org.rti.webgenome.webui.struts.upload.AttachDataForm"/>
			
	<!-- Form for specifying reporter column name -->
		<form-bean
			name="reporter.column.name.form"
			type="org.rti.webgenome.webui.struts.upload.ReporterColumnNameForm"/>
			
	<!-- Form for uploading data -->
		<form-bean
			name="upload.form"
			type="org.rti.webgenome.webui.struts.upload.UploadForm"/>
	</form-beans>


	<!-- =========================================================== -->
	<!--                   Exception handlers                        -->
	<!-- =========================================================== -->
	<global-exceptions>

    <exception
    	type="org.rti.webgenome.webui.SessionTimeoutException"
    	path="session.timeout.exception.page"
    	key="session.timeout"
    	handler="org.rti.webgenome.webui.struts.WebcghExceptionHandler"
    	scope="request"/>

    <exception
    	type="org.rti.webgenome.core.WebGenomeSystemException"
    	path="system.exception.page"
    	key="system.exception"
    	handler="org.rti.webgenome.webui.struts.WebcghExceptionHandler"
    	scope="request"/>

    <exception
    	type="org.rti.webgenome.core.WebGenomeApplicationException"
    	path="application.exception.page"
    	key="application.exception"
    	handler="org.rti.webgenome.webui.struts.WebcghExceptionHandler"
    	scope="request"/>

    <exception
    	type="java.lang.Exception"
    	path="unknown.exception.page"
    	key="system.exception"
    	handler="org.rti.webgenome.webui.struts.WebcghExceptionHandler"
    	scope="request"/>

  	</global-exceptions>



	<!-- ================================================= -->
	<!--                   Actions                         -->
	<!-- ================================================= -->

	<action-mappings>

	<!-- Home -->
		<action
			path="/home"
			type="org.apache.struts.actions.ForwardAction"
			parameter="home.page"/>

		<!-- ============ Shopping cart actions ========= -->
		
	<!-- Upload form -->
		<action
			path="/cart/uploadForm">
			<forward name="success" path="cart.upload.form"/>	
		</action>

	<!-- Show cart -->
		<action path="/cart/showCart">
			<forward name="success" path="cart.show.cart"/>
		</action>

	<!-- Remove experiment -->
		<action path="/cart/removeExperiment">
			<forward name="success" path="/cart/showCart.do"/>
			<forward name="referenced" path="cart.deny.remove"/>
		</action>

	<!-- Remove plot -->
		<action path="/cart/removePlot">
			<forward name="success" path="/cart/showCart.do"/>
			<forward name="referenced" path="cart.deny.remove"/>
		</action>

	<!-- Perform some operation on selected experiments -->
		<action
			path="/cart/routeToOperationPage"
			name="selected.experiments.form"
			scope="session"
			validate="true"
			input="/cart/showCart.do">
			<forward name="plot" path="cart.select.plot.type"/>
			<forward name="analysis" path="/cart/selectAnalysis.do"/>
			<forward name="import" path="/cart/selectImportDataType.do"/>
			<forward name="cart" path="/cart/showCart.do"/>
			<forward name="error" path="/cart/showCart.do"/>
		</action>
		
	<!-- Select type of data to import from client -->
		<action
			path="/cart/selectImportDataType">
			<forward name="success" path="cart.select.import.data.type"/>
		</action>
		
	<!-- Import data from client -->
		<action
			path="/cart/import"
			name="quantitation.type.form"
			scope="session"
			validate="false">
			<forward name="success" path="/cart/showCart.do"/>
			<forward name="unsupported.quantitation.type"
				path="/cart/selectImportDataType.do"/>
		</action>

	<!-- Select analytic operation -->
		<action
			path="/cart/selectAnalysis"
			name="selected.experiments.form"
			scope="session"
			validate="true"
			input="/cart/showCart.do">
			<forward name="success" path="cart.select.analysis"/>
		</action>

	<!-- Plot parameters page -->
		<action
			path="/cart/plotParameters"
			name="plot.parameters.form"
			scope="session"
			validate="false">
			<forward name="success" path="cart.plot.params"/>
		</action>

	<!-- Annotation plot parameters -->
		<action path="/cart/annotationPlotParams">
			<forward name="success" path="cart.annotation.plot.params"/>
		</action>

	<!-- New plot -->
		<action
			path="/cart/newPlot"
			name="plot.parameters.form"
			validate="true"
			input="/cart/plotParameters.do"
			scope="session">
			<forward name="non.batch" path="/cart/showPlot.do"/>
			<forward name="batch" path="/cart/showJobs.do"/>
		</action>
        
	<!-- Show plot -->
		<action
			path="/cart/showPlot">
			<forward name="success" path="cart.show.plot"/>
		</action>

	<!-- Show jobs table -->
		<action path="/cart/showJobs">
			<forward name="success" path="cart.show.jobs"/>
		</action>

	<!-- Job details -->
		<action path="/cart/jobDetails">
			<forward name="success" path="cart.job.details"/>
		</action>
		
	<!-- Purge jobs -->
		<action path="/cart/purgeJobs">
			<forward name="success" path="/cart/showJobs.do"/>
		</action>

	<!-- Set display names of experiments and bioassays -->
		<action
			path="/cart/setDisplayNames"
			type="org.apache.struts.actions.ForwardAction"
			parameter="cart.set.display.names"/>

	<!-- Set analytic operation parameters -->
		<action
			path="/cart/analysisParams"
			name="analytic.operation.params.form"
			validate="false">
			<forward name="success" path="cart.analysis.params"/>
		</action>
		
	<!-- Set up for re-running analytic operation -->
		<action path="/cart/rerunAnalysisParams">
			<forward name="success" path="cart.rerun.analysis.params"/>
		</action>
			

	<!-- Perform analytic operation -->
		<action
			path="/cart/analysis"
			name="analytic.operation.params.form"
			validate="true"
			input="/cart/analysisParams.do">
			<forward name="non.batch" path="/cart/showCart.do"/>
			<forward name="batch" path="/cart/showJobs.do"/>
		</action>
		
	<!-- Rerun analytic operation -->
		<action
			path="/cart/rerunAnalysis"
			name="analytic.operation.params.form"
			validate="true"
			input="/cart/rerunAnalysisParams.do">
			<forward name="non.batch" path="/cart/showCart.do"/>
			<forward name="batch" path="/cart/showJobs.do"/>
		</action>
		
	<!-- Adjust analysis parameters from a plot screen -->
		<action path="/cart/adjustPlotAnalysisParamsSetup">
			<forward name="success" path="cart.adjust.plot.analysis.params"/>
		</action>
			
	<!--
		 Adjust analysis parameters for all derived experiments in
		 a plot.
	-->
		<action path="/cart/adjustPlotAnalysisParams">
			<forward name="non.batch" path="/cart/newPlot.do"/>
			<forward name="errors" path="/cart/adjustPlotAnalysisParamsSetup.do"/>
			<forward name="batch" path="/cart/showJobs.do"/>
		</action>

	<!-- Show color chooser -->
		<action
			path="/cart/colorChooser">
			<forward name="success" path="/WEB-INF/jsp/cart/colorChooser.jsp"/>
		</action>

	<!-- Change color of bioassay -->
		<action
			path="/cart/changeBioAssayColor">
			<forward name="success" path="/cart/showCart.do"/>
		</action>

	<!-- Show name chooser -->
		<action
			path="/cart/nameChooser"
			type="org.apache.struts.actions.ForwardAction"
			parameter="/WEB-INF/jsp/cart/nameChooser.jsp"/>

	<!-- Change name of experiment, bioassay, or plot -->
		<action
			path="/cart/nameChange"
			name="name.change.form"
			validate="true"
			scope="request"
			input="/cart/nameChooser.do">
			<forward name="success" path="/cart/showCart.do"/>
		</action>

	<!-- View/change plot parameters -->
		<action
			path="/cart/changeParameters"
			name="plot.parameters.form"
			validate="false"
			scope="session">
			<forward name="success" path="/cart/plotParameters.do"/>
		</action>

		<!-- ========= Account management actions ========= -->

	<!-- Login -->
		<action
			path="/user/login"
			type="org.apache.struts.actions.ForwardAction"
			parameter="user.login"/>

	<!-- Logout -->
		<action
			path="/user/logout">
			<forward name="success" path="/user/login.do"/>
		</action>

	<!-- Validate login credentials -->
		<action
			path="/user/validateLogin"
			name="login.form"
			scope="request"
			validate="true"
			input="/user/login.do">
			<forward name="success" path="user.confirm.login"/>
			<forward name="failure" path="/user/login.do"/>
		</action>

	<!-- Confirm login -->
		<action
			path="/user/confirmLogin"
			type="org.apache.struts.actions.ForwardAction"
			parameter="user.confirm.login"/>

	<!-- Create account -->
		<action
			path="/user/newAccount"
			type="org.apache.struts.actions.ForwardAction"
			parameter="user.new.account"/>

	<!-- Validate login credentials -->
		<action
			path="/user/createAccount"
			name="new.account.form"
			scope="request"
			validate="true"
			input="/user/newAccount.do">
			<forward name="success" path="user.confirm.new.account"/>
			<forward name="failure" path="/user/newAccount.do"/>
		</action>

		<!-- ============= Client plotting actions ======== -->

		<action
			path="/client/testPlot"
			name="plot.parameters.form"
			validate="false">
			<forward name="success" path="/cart/newPlot.do"/>
		</action>
        
        <action
            path="/client/plot"
            name="plot.parameters.form"
            validate="false">
            <forward name="success" path="/cart/newPlot.do"/>
        </action>
        
        <!-- ============ Upload actions ============= -->
        
     <!-- Initialize upload form -->
        <action path="/upload/initializeUploadForm">
        	<forward name="success" path="/upload/showUploadForm.do"/>
        </action>
        
     <!-- Show upload form -->
        <action path="/upload/showUploadForm">
        	<forward name="success" path="upload.main.upload.form"/>
        </action>
	
	<!-- Data file upload form -->
		<action path="/upload/dataFileUploadForm"
        	type="org.apache.struts.actions.ForwardAction"
        	parameter="upload.data.file.upload.form"/>
        	
	<!-- ZIP file upload form -->
		<action path="/upload/zipFileUploadForm"
        	type="org.apache.struts.actions.ForwardAction"
        	parameter="upload.zip.file.upload.form"/>
        	
    <!-- Upload data file to server -->
        <action
        	path="/upload/uploadDataFile"
        	name="attach.data.form"
        	scope="session"
        	validate="true"
        	input="/upload/dataFileUploadForm.do">
        	<forward name="success" path="/upload/specifyDataColumns.do"/>
        </action>
        
    <!-- Upload ZIP file to server -->
        <action
        	path="/upload/uploadZipFile"
        	name="attach.data.form"
        	scope="session"
        	validate="true"
        	input="/upload/zipFileUploadForm.do">
        	<forward name="success" path="/upload/specifyZipDataColumns.do"/>
        </action>
        
    <!-- Specify data containing columns in an uploaded data fle -->
        <action path="/upload/specifyDataColumns">
        	<forward name="success" path="upload.specify.data.columns"/>
        </action>
        
    <!-- Specify data containing columns in all files in a ZIP archive -->
        <action path="/upload/specifyZipDataColumns">
        	<forward name="success" path="upload.specify.zip.data.columns"/>
        </action>
        
    <!-- Record set of data columns selected -->
        <action
        	path="/upload/attachDataFile"
        	name="reporter.column.name.form"
        	scope="session"
        	validate="true"
        	input="/upload/specifyDataColumns.do">
        	<forward name="success" path="/upload/showUploadForm.do"/>
        	<forward name="errors" path="/upload/specifyDataColumns.do"/>
        </action>
        
    <!-- Record set of data columns selected for ZIP files -->
    <!--
        <action
        	path="/upload/attachZipDataFile"
        	name="reporter.column.name.form"
        	scope="session"
        	validate="true"
        	input="/upload/specifyZipDataColumns.do">
        	<forward name="success" path="/upload/showUploadForm.do"/>
        	<forward name="errors" path="/upload/specifyZipDataColumns.do"/>
        </action>
    -->
        
    <!-- Remove data file from upload -->
        <action path="/upload/removeDataFile">
        	<forward name="success" path="/upload/showUploadForm.do"/>
        </action>
        	
    <!-- Reporter file upload form -->
        <action path="/upload/reporterFileUploadForm"
        	type="org.apache.struts.actions.ForwardAction"
        	parameter="upload.reporter.file.upload.form"/>
        	
    <!-- Upload reporter file to server -->
        <action
        	path="/upload/uploadReporterFile"
        	name="attach.data.form"
        	scope="session"
        	validate="true"
        	input="/upload/reporterFileUploadForm.do">
        	<forward name="success" path="/upload/specifyReporterColumns.do"/>
        </action>
        
   <!-- Specify reporter name columns in an uploaded data fle -->
        <action path="/upload/specifyReporterColumns">
        	<forward name="success" path="upload.specify.reporter.columns"/>
        </action>
	        
	  <!-- Record set of data columns selected -->
        <action
        	path="/upload/attachReporterFile"
        	name="reporter.column.name.form"
        	scope="session"
        	validate="true"
        	input="/upload/specifyReporterColumns.do">
        	<forward name="success" path="/upload/showUploadForm.do"/>
        	<forward name="errors" path="/upload/specifyReporterColumns.do"/>
        </action>
        
        <!-- Remove data file from upload -->
        <action path="/upload/removeReporterFile">
        	<forward name="success" path="/upload/showUploadForm.do"/>
        </action>
        
     <!-- Upload data -->
        <action path="/upload/uploadData"
        	name="upload.form"
        	scope="session"
        	validate="true"
        	input="/upload/showUploadForm.do">
        	<forward name="non.batch" path="/cart/showCart.do"/>
			<forward name="batch" path="/cart/showJobs.do"/>
        </action>

		<!-- ============ Administration actions ======== -->

	<!-- Admin home -->
		<action
			path="/admin/home"
			type="org.apache.struts.actions.ForwardAction"
			parameter="admin.home"/>

	<!-- Load cytobands form -->
		<action path="/admin/loadCytobandsForm">
			<forward name="success" path="admin.load.cytobands"/>
		</action>

	<!-- Load cytobands -->
		<action
			path="/admin/loadCytobands"
			name="annotation.upload.form"
			scope="request"
			validate="true"
			input="/admin/loadCytobandsForm.do">
			<forward name="success" path="/admin/loadCytobandsForm.do"/>
		</action>

	<!-- Delete cytobands -->
		<action path="/admin/deleteCytobands">
			<forward name="success" path="/admin/loadCytobandsForm.do"/>
		</action>
		
	<!-- Load genes form -->
		<action path="/admin/loadGenesForm">
			<forward name="success" path="admin.load.genes"/>
		</action>
		
	<!-- Load cytobands -->
		<action
			path="/admin/loadGenes"
			name="annotation.upload.form"
			scope="request"
			validate="true"
			input="/admin/loadGenesForm.do">
			<forward name="success" path="/admin/loadGenesForm.do"/>
		</action>
		
	<!-- Delete genes -->
		<action path="/admin/deleteGenes">
			<forward name="success" path="/admin/loadGenesForm.do"/>
		</action>
        
    <!-- Status Page -->
        <action
            path="/status"
            type="org.apache.struts.actions.ForwardAction"
            parameter="status.page"/>
            
         <!-- ========= AJAX actions ============== -->
         
         <action path="/ajax/newlyChangedJobs">
         	<forward name="success"
         		path="/WEB-INF/jsp/ajax/newlyChangedJobs.jsp"/>
         </action>

	</action-mappings>


	<!-- ==================================================== -->
	<!--            Controller                                -->
	<!-- ==================================================== -->

<!-- Spring controller for Tiles -->
	<controller>
	  <set-property property="processorClass"
	      value="org.springframework.web.struts.DelegatingTilesRequestProcessor"/>
	</controller>

	<!-- =========================================================== -->
	<!--                  Plug-ins                                   -->
	<!-- =========================================================== -->

<!-- Tiles -->
	<plug-in className="org.apache.struts.tiles.TilesPlugin" >
	    <set-property property="definitions-config"
		                 value="/WEB-INF/tiles-config.xml" />
	    <set-property property="moduleAware" value="true" />
	    <set-property property="definitions-parser-validate" value="true" />
	</plug-in>

<!-- Spring context loader -->
	<plug-in className="org.springframework.web.struts.ContextLoaderPlugIn">
	  <set-property property="contextConfigLocation"
	      value="/WEB-INF/applicationContext.xml"/>
	</plug-in>
</struts-config>